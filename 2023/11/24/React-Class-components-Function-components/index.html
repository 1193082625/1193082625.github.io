<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="Echo">





<title>React Class components &amp; Function components | Hexo</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 7.0.0"></head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const currentTheme = window.localStorage && window.localStorage.getItem('theme') || '';
            const isDark = currentTheme === 'dark';
            const pagebody = document.getElementsByTagName('body')[0]
            if (isDark) {
                pagebody.classList.add('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Dark"
            } else {
                pagebody.classList.remove('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Light"
            }
        })();
    </script>

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">Echo&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">Echo&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6; // 为 6 时展开所有
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function() {
            tocbot.refresh(obj_merge(tocbot_default_config, {
                hasInnerContainers: true
            }));
        }, 420); // 这个值是由 tocbot 源码里定义的 scrollSmoothDuration 得来的
    }

    document.ready(function() {
        tocbot.init(obj_merge(tocbot_default_config, {
            collapseDepth: 1
        }));
    });

    function expand_toc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, {
            collapseDepth: expanded ? 1 : DEPTH_MAX
        }));
        b.innerText = expanded ? 'Expand all' : 'Collapse all';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">React Class components &amp; Function components</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">Echo</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">November 24, 2023&nbsp;&nbsp;10:36:25</a>
                        </span>
                    
                    
                </div>
            
        </header>

        <div class="post-content">
            <p>This blog here mainly compares some of React APIs between Function Component and Class Component.</p>
<blockquote>
<p><strong>The following equality are not equal in the true sense, but can be understood in contrast</strong></p>
</blockquote>
<ul>
<li><p><strong>props</strong></p>
<p>If we need receive a prop named “name” from parent component, we can do like this:</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// in class component</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Com</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">	<span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, &#123;this.props.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// in function component</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Com</span>(<span class="params">&#123;name&#125;</span>) &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, &#123;name&#125;!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// use it</span></span><br><span class="line">&lt;<span class="title class_">Com</span> name=<span class="string">&quot;world&quot;</span>/&gt;</span><br></pre></td></tr></table></figure>

<p>Note that defining defaultProps in a class component is similar to using default values in a functional component</p>
</li>
<li><p><strong>state</strong></p>
<p>If we want use state: </p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// in class component</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Com</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span>&#123;</span><br><span class="line">	state = &#123;</span><br><span class="line">		<span class="attr">name</span>: <span class="string">&#x27;world&#x27;</span>,</span><br><span class="line">	&#125;</span><br><span class="line">	handleNameChange = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">		<span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">			<span class="attr">name</span>: e.<span class="property">target</span>.<span class="property">value</span></span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello, &#123;this.state.name&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">value</span>=<span class="string">&#123;this.state.name&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;this.handleNameChange&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">		)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// in function component</span></span><br><span class="line"><span class="keyword">import</span> &#123;useState&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Com</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [name, setName] = <span class="title function_">useState</span>(<span class="string">&#x27;world&#x27;</span>);</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">handleNameChange</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="title function_">setName</span>(e.<span class="property">target</span>.<span class="property">value</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello, &#123;this.state.name&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">value</span>=<span class="string">&#123;this.state.name&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;this.handleNameChange&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>ref【class】 &#x3D; createRef 【function】</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// in class component</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Com</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">	inputRef = <span class="title function_">createRef</span>();</span><br><span class="line">	handleClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">		<span class="variable language_">this</span>.<span class="property">inputRef</span>.<span class="property">current</span>.<span class="title function_">focus</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> (</span><br><span class="line">			<span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">				<span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;this.inputRef&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">				<span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick&#125;</span>&gt;</span>focus<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">			<span class="tag">&lt;/&gt;</span></span></span><br><span class="line">		)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// in function component</span></span><br><span class="line"><span class="keyword">import</span> &#123;useRef&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Com</span>(<span class="params"></span>) &#123;</span><br><span class="line">	<span class="keyword">const</span> inputRef=<span class="title function_">useRef</span>(<span class="literal">null</span>);</span><br><span class="line">	<span class="keyword">function</span> <span class="title function_">handleClick</span>(<span class="params"></span>) &#123;</span><br><span class="line">		inputRef.<span class="property">curent</span>.<span class="title function_">focus</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> (</span><br><span class="line">		<span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">			<span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;inputRef&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">			<span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleClick&#125;</span>&gt;</span>focus<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;/&gt;</span></span></span><br><span class="line">	)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</li>
<li><p>context &#x3D; useContext</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// in class component</span><br><span class="line">Waiting for replenishment...</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="Life-cycle-function"><a href="#Life-cycle-function" class="headerlink" title="Life cycle function"></a>Life cycle function</h4><ul>
<li><strong>componentDidMount + componentDidUpdate + componentWillUnmount &#x3D; useEffect</strong></li>
</ul>
<p>​		If we have a logic like this:</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// in class component</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Com</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">	state = &#123;</span><br><span class="line">		<span class="attr">serverUrl</span>: <span class="string">&#x27;https://localhost:1234&#x27;</span></span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">		<span class="variable language_">this</span>.<span class="title function_">setupConnection</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="title function_">componentDidUpdate</span>(<span class="params">preProps, preState</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span>(</span><br><span class="line">			<span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">roomId</span> !== preProps.<span class="property">roomId</span></span><br><span class="line">			|| <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">serverUrl</span> !== preState.<span class="property">serverUrl</span></span><br><span class="line">		) &#123;</span><br><span class="line">			<span class="variable language_">this</span>.<span class="title function_">destroyConnection</span>();</span><br><span class="line">			<span class="variable language_">this</span>.<span class="title function_">setupConnection</span>();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="title function_">componentWillUnmount</span>(<span class="params"></span>) &#123;</span><br><span class="line">		<span class="variable language_">this</span>.<span class="title function_">destoryConnection</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">  <span class="title function_">setupConnection</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">connection</span> = <span class="title function_">createConnection</span>(</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">serverUrl</span>,</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">roomId</span></span><br><span class="line">    );</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">connection</span>.<span class="title function_">connect</span>();    </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">destroyConnection</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">connection</span>.<span class="title function_">disconnect</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">connection</span> = <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">	...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// in function component </span></span><br><span class="line"><span class="keyword">import</span> &#123;useState, useEffect&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Com</span>(<span class="params">&#123;roomId&#125;</span>) &#123;</span><br><span class="line">	<span class="keyword">const</span> [serverUrl, serServerUrl] = <span class="title function_">useState</span>(<span class="string">&#x27;http://localhost:1234&#x27;</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">		<span class="keyword">const</span> connection = <span class="title function_">createConnection</span>(serverUrl, roomId);</span><br><span class="line">		connection.<span class="title function_">connect</span>();</span><br><span class="line">		<span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">			connection.<span class="title function_">disconnect</span>();</span><br><span class="line">		&#125;;</span><br><span class="line">	&#125;, [serverUrl, roomId]);</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This useEffect is equivalent to the logic implemented by the above several lifecycle functions</p>
<ul>
<li><p>componentDidCatch (Not yet)</p>
</li>
<li><p>getSnapshotBeforeUpdata (Not yet)</p>
</li>
<li><p>shouldComponentUpdate &#x3D; React.memo</p>
</li>
<li><p>getDerivedStateFromProps</p>
<p>this funcion is used to replace componentWillReceiveProps</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">// in class component</span><br><span class="line">class Com extends Component &#123;</span><br><span class="line">	state = &#123;</span><br><span class="line">		lastRow: null,</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	static getDerivedStateFromProps(props, state) &#123;</span><br><span class="line">		if(props.currentRow !== state.lastRow) &#123;</span><br><span class="line">			rturn &#123;</span><br><span class="line">				lastRow: props.currentRow</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		// return null to indicate no change to state</span><br><span class="line">		return null;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// in function component</span><br><span class="line">function Com(&#123;row&#125;) &#123;</span><br><span class="line">	let [prevRow, setPrevRow] = useState(null);</span><br><span class="line">	</span><br><span class="line">	if(row !== prevRow) &#123;</span><br><span class="line">		setPrevRow(row);</span><br><span class="line">	&#125;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h4><ul>
<li><p>static getDerivedStateFromError(error)</p>
<p>When the child component in render process has mistakes, it will be dispatched. It could help you show the error message rather than clean UI。</p>
</li>
</ul>
<p>​		Not yet in function component</p>
<h4 id="React-Hooks"><a href="#React-Hooks" class="headerlink" title="React Hooks"></a>React Hooks</h4><p>Except for the hooks mentioned above, here are others hooks:</p>
<ul>
<li><p>useReducer</p>
</li>
<li><p>useCallback</p>
<p>It allows we to cache functions in multiple renders</p>
<ul>
<li>Skip rerendering of components, it means <code>useCallback</code> caches a function in multiple renders , until the dependency of that function changes.</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import &#123;useCallback&#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">function ProductPage(&#123;productId, referer, theme&#125;) &#123;</span><br><span class="line">	const handleSubmit = (orderDetails) =&gt; &#123;</span><br><span class="line">		post(`/product/$&#123;productId&#125;/bug`, &#123;</span><br><span class="line">			referrer, orderDetails</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;;</span><br><span class="line">	</span><br><span class="line">	return (</span><br><span class="line">		&lt;div className=&#123;theme&#125;&gt;</span><br><span class="line">			&lt;ShippingForm onSubmit=&#123;handleSubmit&#125; /&gt;</span><br><span class="line">		&lt;/div&gt;</span><br><span class="line">	)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>By default, when a component is re-rendered, React recursively renders all of it’s child components. So whenever thr ProductPage component is rerenderer because of the theme change, this ShippingForm component is alse rerenderer. We can wrap the ShippingForm component in the <code>memo</code>. If the props are the same as the last render, the ShippingForm component skips the re-render.</p>
<p><strong>This is where the cache function becomes important</strong>. Assume that handleSunmit is defined but useCallback is not, this will cause the ShippingForm props to never be the same, and it will re-render every time, the performance optimizations of memo will never take effect.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import &#123;useCallback&#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">function ProductPage(&#123;productId, referer, theme&#125;) &#123;</span><br><span class="line">	// Passing handleSubmit to useCallback ensures that it is the same function across multiple re-renders until the dependency changes</span><br><span class="line">	const handleSubmit = useCallback((orderDetails) =&gt; &#123;</span><br><span class="line">		post(`/product/$&#123;productId&#125;/bug`, &#123;</span><br><span class="line">			referrer, orderDetails</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;, [productId, referrer]);</span><br><span class="line">	</span><br><span class="line">	return (</span><br><span class="line">		&lt;div className=&#123;theme&#125;&gt;</span><br><span class="line">			&lt;ShippingForm onSubmit=&#123;handleSubmit&#125; /&gt;</span><br><span class="line">		&lt;/div&gt;</span><br><span class="line">	)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>useMemo</p>
<p>useMemo often appears with useCallback</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import &#123;useMemo, useCallback&#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">function ProductPage(&#123;productId, referrer&#125;) &#123;</span><br><span class="line">	const product = useData(`/product/$&#123;productId&#125;`);</span><br><span class="line">	</span><br><span class="line">	// useMemo caches the result of a function call</span><br><span class="line">	// It will not change unless the product changes</span><br><span class="line">	const requirements = useMemo(() =&gt; &#123;</span><br><span class="line">		return compiteRequirements(product);</span><br><span class="line">	&#125;, [product]);</span><br><span class="line">	</span><br><span class="line">	// useCallback cache function itself</span><br><span class="line">	const handleSubmit = useCallback((orderDetails) =&gt; &#123;</span><br><span class="line">		...</span><br><span class="line">	&#125;, [productId, referrer]);</span><br><span class="line">	</span><br><span class="line">	return (</span><br><span class="line">		&lt;div className=&#123;theme&#125;&gt;</span><br><span class="line">			&lt;ShippingForm requirements=&#123;requirements&#125; onSubmit=&#123;handleSubmit&#125;/&gt;</span><br><span class="line">		&lt;/div&gt;</span><br><span class="line">	)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</li>
<li><p>useInperativeHandle 【function】 &#x3D; forwardRef 【class】</p>
</li>
<li><p>useDebugValue</p>
</li>
<li><p>useDeferredValue</p>
</li>
<li><p>useId</p>
</li>
<li><p>useInperativeHandle</p>
</li>
<li><p>useInsertionEffect</p>
</li>
<li><p>useLayoutEffect</p>
</li>
<li><p>useSyncExternalStore</p>
</li>
<li><p>useTransition</p>
</li>
</ul>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>Echo</span>
                    </p>
                
                
                
                
                     <p class="copyright-item">
                         <span>Slogan:</span>
                         <span>It's time for change</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/react/"># react</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2023/11/26/Record-the-problem-of-creating-react-native-project-on-mac/">Record the problem of creating react native project on mac</a>
            
            
            <a class="next" rel="next" href="/2023/11/24/Electron-Vue/">Electron+Vue</a>
            
        </section>


    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>© Echo</span>
    </div>
</footer>

    </div>
</body>

</html>